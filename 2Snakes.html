<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multiplayer Snake Game</title>
    <style>
        /* Basic styling for the body */
        body {
            display: flex; /* Use flexbox for alignment */
            flex-direction: column; /* Stack elements vertically */
            align-items: center; /* Center elements horizontally */
            font-family: 'Arial', sans-serif; /* Font family */
            background: linear-gradient(to bottom right, #1b1b1b, #3a3a3a); /* Dark gradient background */
            color: #ffffff; /* White text color */
            margin: 0; /* Remove default margin */
            padding: 20px; /* Add padding around the content */
        }

        /* Styling for the main heading */
        h1 {
            font-size: 3em; /* Large font size */
            margin-bottom: 10px; /* Space below the heading */
            text-shadow: 3px 3px 10px rgba(0, 0, 0, 0.8); /* Shadow effect for text */
            letter-spacing: 2px; /* Space between letters */
        }

        /* Styling for the control panel */
        #controls {
            margin: 20px; /* Margin around controls */
            display: flex; /* Use flexbox for layout */
            flex-direction: column; /* Stack controls vertically */
            background: rgba(42, 42, 42, 0.9); /* Dark semi-transparent background */
            padding: 20px; /* Padding inside the controls */
            border-radius: 12px; /* Rounded corners */
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.6); /* Shadow effect */
            transition: background 0.3s, transform 0.2s; /* Transition effects */
        }

        /* Hover effect for controls */
        #controls:hover {
            background: rgba(42, 42, 42, 1); /* Darker background on hover */
            transform: translateY(-2px); /* Slight upward movement */
        }

        /* Styling for labels */
        label {
            margin: 10px 0 5px; /* Margins around labels */
            font-weight: bold; /* Bold font for labels */
            font-size: 1.1em; /* Slightly larger font size */
        }

        /* Styling for input fields */
        input {
            padding: 12px; /* Padding inside input */
            border: 2px solid #4CAF50; /* Green border */
            border-radius: 5px; /* Rounded corners */
            margin-bottom: 10px; /* Space below each input */
            background-color: #2a2a2a; /* Dark background for input */
            color: #ffffff; /* White text color */
            transition: border-color 0.3s, background 0.3s; /* Transition effects */
        }

        /* Focus effect for input fields */
        input:focus {
            border-color: #76c7c0; /* Change border color on focus */
            background-color: #3c3c3c; /* Change background color on focus */
            outline: none; /* Remove outline */
        }

        /* Styling for buttons */
        button {
            padding: 12px; /* Padding inside buttons */
            background-color: #4CAF50; /* Green background */
            color: white; /* White text color */
            border: none; /* Remove border */
            border-radius: 5px; /* Rounded corners */
            cursor: pointer; /* Change cursor to pointer */
            transition: background-color 0.3s, transform 0.2s; /* Transition effects */
            font-size: 1em; /* Font size */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3); /* Shadow effect */
        }

        /* Hover effect for buttons */
        button:hover {
            background-color: #45a049; /* Darker green on hover */
            transform: scale(1.05); /* Slightly enlarge on hover */
        }

        /* Styling for the game canvas */
        canvas {
            border: 2px solid #ffffff; /* White border */
            display: none; /* Initially hidden */
            margin-top: 20px; /* Space above canvas */
            border-radius: 10px; /* Rounded corners */
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.5); /* Glow effect */
        }

        /* Styling for score display */
        #score {
            font-size: 28px; /* Font size */
            margin-top: 10px; /* Space above score */
            text-shadow: 1px 1px 5px rgba(0, 0, 0, 0.8); /* Shadow effect */
        }

        /* Styling for game info panel */
        #game-info {
            display: none; /* Initially hidden */
            background: rgba(42, 42, 42, 0.9); /* Dark semi-transparent background */
            padding: 20px; /* Padding inside the info panel */
            border-radius: 12px; /* Rounded corners */
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.6); /* Shadow effect */
        }

        /* Styling for game info heading */
        #game-info h2 {
            margin: 0 0 10px; /* Margins around heading */
            text-shadow: 1px 1px 3px rgba(255, 255, 255, 0.6); /* Shadow effect */
        }

        /* Styling for close button in game info */
        #closeInfo {
            background-color: #f44336; /* Red background */
            transition: background-color 0.3s; /* Transition effect */
        }

        /* Hover effect for close button */
        #closeInfo:hover {
            background-color: #d32f2f; /* Darker red on hover */
        }
    </style>
</head>
<body>
    <h1>Multiplayer Snake Game</h1>
    <div id="controls">
        <label for="boardSize">Board Size (10-50):</label>
        <input type="number" id="boardSize" min="10" max="50" value="20">
        
        <label for="snakeSpeed">Snake Speed (1-10):</label>
        <input type="number" id="snakeSpeed" min="1" max="10" value="2">
        
        <label for="numApples">Number of Apples (1-50):</label>
        <input type="number" id="numApples" min="1" max="50" value="2">
        
        <label for="powerUpFreq">Power Up Frequency (1-100s):</label>
        <input type="number" id="powerUpFreq" min="1" max="100" value="10">
        
        <button id="startBtn">Start Game</button>
        <button id="infoBtn">Game Info</button>
    </div>
    
    <canvas id="gameCanvas" width="400" height="400"></canvas>
    <div id="score">Score: 0</div>
    <div id="game-info">
        <h2>Game Rules</h2>
        <p>Player 1 (Cyan): W, A, S, D | Player 2 (Teal): Arrow Keys</p>
        <p>Eat apples to grow longer and earn points. Avoid colliding with yourself or the other player!</p>
        <p>Power-ups appear randomly:</p>
        <ul>
            <li>1 - Speed Up</li>
            <li>2 - Speed Down</li>
            <li>3 - Score Up</li>
        </ul>
        <button id="closeInfo">Close</button>
    </div>

    <script>
        // Get elements from the DOM
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d'); // Get 2D drawing context
        const scoreDisplay = document.getElementById('score');
        const startBtn = document.getElementById('startBtn');
        const infoBtn = document.getElementById('infoBtn');
        const gameInfo = document.getElementById('game-info');
        const closeInfo = document.getElementById('closeInfo');

        // Initialize game settings with localStorage values or defaults
        let boardSize = parseInt(localStorage.getItem('boardSize')) || 20;
        let snakeSpeed = parseInt(localStorage.getItem('snakeSpeed')) || 5;
        let numApples = parseInt(localStorage.getItem('numApples')) || 3;
        let powerUpFreq = (parseInt(localStorage.getItem('powerUpFreq')) || 10) * 1000;
        let snakes, apples, powerUps, gameInterval, gameRunning, powerUpTimer;
        let score1, score2;

        // Function to initialize the game
        function initGame() {
            // Retrieve user settings from inputs
            boardSize = parseInt(document.getElementById('boardSize').value);
            snakeSpeed = parseInt(document.getElementById('snakeSpeed').value);
            numApples = parseInt(document.getElementById('numApples').value);
            powerUpFreq = parseInt(document.getElementById('powerUpFreq').value) * 1000;

            // Save settings to localStorage
            localStorage.setItem('boardSize', boardSize);
            localStorage.setItem('snakeSpeed', snakeSpeed);
            localStorage.setItem('numApples', numApples);
            localStorage.setItem('powerUpFreq', powerUpFreq / 1000);

            // Setup game state
            snakes = [
                { body: [{ x: 5, y: 5 }], direction: 'right' }, // Player 1
                { body: [{ x: 15, y: 15 }], direction: 'left' }  // Player 2
            ];
            apples = [];
            powerUps = [];
            score1 = 0;
            score2 = 0;
            gameRunning = true;

            // Generate initial apples
            for (let i = 0; i < numApples; i++) {
                spawnApple();
            }

            // Start game loop
            gameInterval = setInterval(gameLoop, 1000 / snakeSpeed);
            draw();
        }

        // Function to spawn an apple at a random position
        function spawnApple() {
            let apple = {
                x: Math.floor(Math.random() * boardSize),
                y: Math.floor(Math.random() * boardSize)
            };

            // Ensure apple doesn't spawn on snake bodies
            if (!snakes.some(snake => snake.body.some(segment => segment.x === apple.x && segment.y === apple.y))) {
                apples.push(apple);
            } else {
                spawnApple(); // Try again if position is occupied
            }
        }

        // Function to draw game elements
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height); // Clear the canvas
            ctx.fillStyle = 'black'; // Background color
            ctx.fillRect(0, 0, canvas.width, canvas.height); // Draw background

            // Draw snakes
            snakes.forEach((snake, index) => {
                ctx.fillStyle = index === 0 ? 'cyan' : 'teal'; // Color based on player
                snake.body.forEach(segment => {
                    ctx.fillRect(segment.x * 20, segment.y * 20, 18, 18); // Draw each segment
                });
            });

            // Draw apples
            ctx.fillStyle = 'red'; // Color for apples
            apples.forEach(apple => {
                ctx.fillRect(apple.x * 20, apple.y * 20, 18, 18); // Draw each apple
            });

            // Draw scores
            scoreDisplay.textContent = `Score: ${score1} | ${score2}`;
        }

        // Function for the main game loop
        function gameLoop() {
            // Move snakes based on their current direction
            snakes.forEach((snake, index) => {
                moveSnake(snake);
                checkCollisions(snake, index);
            });

            // Spawn power-ups at intervals
            if (powerUpTimer) clearTimeout(powerUpTimer);
            powerUpTimer = setTimeout(() => {
                spawnPowerUp();
            }, powerUpFreq);
        }

        // Function to move a snake
        function moveSnake(snake) {
            const head = { ...snake.body[0] }; // Get the current head

            // Update head position based on direction
            switch (snake.direction) {
                case 'up': head.y--; break;
                case 'down': head.y++; break;
                case 'left': head.x--; break;
                case 'right': head.x++; break;
            }

            // Add new head to the body
            snake.body.unshift(head);
            snake.body.pop(); // Remove the last segment
        }

        // Function to check for collisions
        function checkCollisions(snake, index) {
            // Check if snake runs into itself or the other snake
            const head = snake.body[0];
            if (snake.body.slice(1).some(segment => segment.x === head.x && segment.y === head.y) ||
                snakes[(index + 1) % 2].body.some(segment => segment.x === head.x && segment.y === head.y)) {
                endGame(index); // End game on collision
            }

            // Check for apple collisions
            apples.forEach((apple, appleIndex) => {
                if (apple.x === head.x && apple.y === head.y) {
                    apples.splice(appleIndex, 1); // Remove apple
                    snake.body.push({}); // Grow snake
                    if (index === 0) score1++; // Update player score
                    else score2++;
                    spawnApple(); // Spawn new apple
                }
            });
        }

        // Function to spawn a power-up
        function spawnPowerUp() {
            const powerUp = {
                x: Math.floor(Math.random() * boardSize),
                y: Math.floor(Math.random() * boardSize)
            };

            // Ensure power-up doesn't spawn on snake bodies
            if (!snakes.some(snake => snake.body.some(segment => segment.x === powerUp.x && segment.y === powerUp.y))) {
                powerUps.push(powerUp); // Add power-up to the array
            } else {
                spawnPowerUp(); // Try again if position is occupied
            }
        }

        // Function to end the game
        function endGame(index) {
            gameRunning = false; // Stop the game loop
            clearInterval(gameInterval); // Clear the interval
            alert(`Game Over! Player ${index + 1} lost!`); // Show game over alert
            resetGame(); // Reset game state
        }

        // Function to reset the game
        function resetGame() {
            snakes = [];
            apples = [];
            powerUps = [];
            score1 = 0;
            score2 = 0;
            draw(); // Redraw the empty state
        }

        // Event listeners for starting the game and showing game info
        startBtn.addEventListener('click', initGame);
        infoBtn.addEventListener('click', () => {
            gameInfo.style.display = 'block'; // Show game info
        });
        closeInfo.addEventListener('click', () => {
            gameInfo.style.display = 'none'; // Hide game info
        });
    </script>
</body>
</html>
